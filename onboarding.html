<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>创建分身 - 邻里分身</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        body { background: var(--bg-base); }
        .phone-frame { width: 100%; max-width: 375px; min-height: 100vh; margin: 0 auto; background: var(--bg-base); }
        
        /* 进度指示 */
        .progress-bar { display: flex; justify-content: center; gap: 8px; padding: 24px 0 16px; }
        .progress-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border-default); transition: all 0.3s; }
        .progress-dot.active { background: var(--primary); width: 24px; border-radius: 4px; }
        .progress-dot.done { background: var(--accent); }
        
        /* 内容区 */
        .content { padding: 0 24px; flex: 1; }
        .step-title { font-size: 26px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px; line-height: 1.3; }
        .step-desc { font-size: 15px; color: var(--text-secondary); margin-bottom: 32px; line-height: 1.5; }
        
        /* 步骤1：命名 */
        .name-input { width: 100%; padding: 18px 20px; font-size: 18px; color: var(--text-primary); background: var(--bg-card); border: 2px solid var(--border-light); border-radius: var(--radius-xl); outline: none; transition: all 0.2s; text-align: center; }
        .name-input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px var(--primary-bg); }
        .name-input::placeholder { color: var(--text-muted); }
        
        /* 步骤2：头像 */
        .avatar-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .avatar-option { aspect-ratio: 1; background: var(--bg-muted); border-radius: var(--radius-xl); display: flex; justify-content: center; align-items: center; cursor: pointer; transition: all 0.2s; border: 3px solid transparent; }
        .avatar-option.selected { border-color: var(--primary); background: var(--primary-bg); }
        .avatar-option i { font-size: 36px; color: var(--text-muted); }
        .avatar-option.selected i { color: var(--primary); }
        
        /* 步骤3：风格 */
        .style-options { display: flex; flex-direction: column; gap: 12px; }
        .style-option { padding: 18px 20px; background: var(--bg-card); border: 2px solid var(--border-light); border-radius: var(--radius-xl); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 14px; }
        .style-option.selected { border-color: var(--primary); background: var(--primary-bg); }
        .style-icon { width: 44px; height: 44px; background: var(--bg-muted); border-radius: var(--radius-md); display: flex; justify-content: center; align-items: center; }
        .style-option.selected .style-icon { background: var(--primary-gradient); }
        .style-icon i { font-size: 20px; color: var(--text-muted); }
        .style-option.selected .style-icon i { color: white; }
        .style-text h4 { font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
        .style-text p { font-size: 13px; color: var(--text-muted); }
        
        /* 步骤4：完成 */
        .success-icon { width: 100px; height: 100px; background: var(--accent-light); border-radius: 50%; display: flex; justify-content: center; align-items: center; margin: 0 auto 24px; }
        .success-icon i { font-size: 48px; color: var(--accent); }
        .success-title { font-size: 24px; font-weight: 700; color: var(--text-primary); text-align: center; margin-bottom: 8px; }
        .success-desc { font-size: 15px; color: var(--text-secondary); text-align: center; line-height: 1.6; }
        
        .avatar-preview { width: 80px; height: 80px; background: var(--primary-gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; margin: 24px auto; box-shadow: var(--shadow-md); }
        .avatar-preview i { font-size: 36px; color: white; }
        
        /* 底部按钮 */
        .bottom-area { padding: 20px 24px; padding-bottom: calc(20px + env(safe-area-inset-bottom, 0px)); }
        .next-btn { width: 100%; height: 56px; background: var(--primary-gradient); border: none; border-radius: var(--radius-xl); color: white; font-size: 17px; font-weight: 600; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px; box-shadow: var(--shadow-md); transition: all 0.2s; }
        .next-btn:active { transform: scale(0.98); }
        .next-btn:disabled { background: var(--bg-muted); color: var(--text-muted); box-shadow: none; }
        
        .skip-btn { width: 100%; height: 48px; background: transparent; border: none; color: var(--text-muted); font-size: 15px; cursor: pointer; margin-top: 12px; }
    </style>
</head>
<body>
    <div class="phone-frame" style="display: flex; flex-direction: column; min-height: 100vh;">
        <div class="progress-bar" id="progressBar">
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>

        <div class="content" id="stepContent">
            <!-- 步骤内容由JS渲染 -->
        </div>

        <div class="bottom-area">
            <button class="next-btn" id="nextBtn" onclick="nextStep()">
                下一步
                <i class="fas fa-arrow-right"></i>
            </button>
            <button class="skip-btn" id="skipBtn" onclick="skipStep()" style="display: none;">跳过</button>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let avatarName = '';
        let selectedAvatar = 0;
        let selectedStyle = 0;

        const avatars = ['fa-user', 'fa-user-tie', 'fa-user-ninja', 'fa-user-astronaut', 'fa-user-secret', 'fa-robot'];
        const styles = [
            { icon: 'fa-comments', name: '热情健谈', desc: '主动交流，善于破冰' },
            { icon: 'fa-briefcase', name: '简洁高效', desc: '直奔主题，不说废话' },
            { icon: 'fa-heart', name: '温柔体贴', desc: '关心细节，善解人意' }
        ];

        renderStep();

        function renderStep() {
            const progressBar = document.getElementById('progressBar');
            const content = document.getElementById('stepContent');
            const nextBtn = document.getElementById('nextBtn');
            const skipBtn = document.getElementById('skipBtn');

            // 更新进度条
            progressBar.innerHTML = '';
            for (let i = 1; i <= 4; i++) {
                let cls = 'progress-dot';
                if (i < currentStep) cls += ' done';
                else if (i === currentStep) cls += ' active';
                progressBar.innerHTML += `<div class="${cls}"></div>`;
            }

            // 渲染内容
            if (currentStep === 1) {
                content.innerHTML = `
                    <div class="step-title">给分身起个名字</div>
                    <div class="step-desc">这是你分身的昵称，邻居会通过这个名字认识TA</div>
                    <input type="text" class="name-input" id="nameInput" placeholder="输入名字..." maxlength="10" value="${avatarName}" oninput="avatarName = this.value">
                `;
                nextBtn.innerHTML = '下一步 <i class="fas fa-arrow-right"></i>';
                skipBtn.style.display = 'none';
            } else if (currentStep === 2) {
                content.innerHTML = `
                    <div class="step-title">选择分身形象</div>
                    <div class="step-desc">选择一个你喜欢的头像风格</div>
                    <div class="avatar-grid">
                        ${avatars.map((a, i) => `
                            <div class="avatar-option ${selectedAvatar === i ? 'selected' : ''}" onclick="selectAvatar(${i})">
                                <i class="fas ${a}"></i>
                            </div>
                        `).join('')}
                    </div>
                `;
                skipBtn.style.display = 'block';
            } else if (currentStep === 3) {
                content.innerHTML = `
                    <div class="step-title">选择沟通风格</div>
                    <div class="step-desc">分身会按照你选择的风格与邻居交流</div>
                    <div class="style-options">
                        ${styles.map((s, i) => `
                            <div class="style-option ${selectedStyle === i ? 'selected' : ''}" onclick="selectStyle(${i})">
                                <div class="style-icon"><i class="fas ${s.icon}"></i></div>
                                <div class="style-text">
                                    <h4>${s.name}</h4>
                                    <p>${s.desc}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                skipBtn.style.display = 'block';
            } else if (currentStep === 4) {
                content.innerHTML = `
                    <div class="success-icon"><i class="fas fa-check"></i></div>
                    <div class="success-title">分身创建成功！</div>
                    <div class="success-desc">你的分身"${avatarName || '小助手'}"已经准备好了<br>现在就去发布第一条需求吧</div>
                    <div class="avatar-preview"><i class="fas ${avatars[selectedAvatar]}"></i></div>
                `;
                nextBtn.innerHTML = '开始使用 <i class="fas fa-arrow-right"></i>';
                skipBtn.style.display = 'none';
            }
        }

        function selectAvatar(i) {
            selectedAvatar = i;
            renderStep();
        }

        function selectStyle(i) {
            selectedStyle = i;
            renderStep();
        }

        function nextStep() {
            if (currentStep === 1 && !avatarName.trim()) {
                avatarName = '小助手';
            }
            
            if (currentStep < 4) {
                currentStep++;
                renderStep();
            } else {
                location.href = 'hall.html';
            }
        }

        function skipStep() {
            currentStep++;
            renderStep();
        }
    </script>
</body>
</html>
