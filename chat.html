<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>聊天 - 邻里分身</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        body { background: var(--bg-muted); }
        .phone-frame { width: 100%; max-width: 375px; min-height: 100vh; margin: 0 auto; background: var(--bg-muted); display: flex; flex-direction: column; }
        
        /* 顶部导航 */
        .chat-header { display: flex; align-items: center; padding: 14px 16px; background: var(--bg-card); border-bottom: 0.5px solid var(--border-light); position: sticky; top: 0; z-index: 100; }
        .back-btn { width: 36px; height: 36px; display: flex; justify-content: center; align-items: center; cursor: pointer; color: var(--text-secondary); }
        .chat-avatar { width: 40px; height: 40px; background: var(--primary-gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 10px; }
        .chat-avatar i { font-size: 18px; color: white; }
        .chat-info { flex: 1; }
        .chat-name { font-size: 16px; font-weight: 600; color: var(--text-primary); }
        .chat-status { font-size: 12px; color: var(--accent); }
        .header-action { width: 36px; height: 36px; display: flex; justify-content: center; align-items: center; cursor: pointer; color: var(--text-muted); }
        
        /* 消息区域 */
        .messages-container { flex: 1; overflow-y: auto; padding: 16px; }
        
        .message-item { display: flex; margin-bottom: 16px; }
        .message-item.sent { flex-direction: row-reverse; }
        
        .message-avatar { width: 36px; height: 36px; background: var(--primary-gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; flex-shrink: 0; }
        .message-avatar i { font-size: 14px; color: white; }
        .message-item.sent .message-avatar { background: var(--bg-muted); }
        .message-item.sent .message-avatar i { color: var(--text-muted); }
        
        .message-content { max-width: 70%; margin: 0 10px; }
        .message-bubble { padding: 12px 16px; border-radius: 18px; font-size: 15px; line-height: 1.5; }
        .message-item.received .message-bubble { background: var(--bg-card); color: var(--text-primary); border-bottom-left-radius: 6px; }
        .message-item.sent .message-bubble { background: var(--primary-gradient); color: white; border-bottom-right-radius: 6px; }
        .message-time { font-size: 11px; color: var(--text-muted); margin-top: 4px; text-align: right; }
        .message-item.received .message-time { text-align: left; }
        
        /* 系统消息 */
        .system-message { text-align: center; margin: 20px 0; }
        .system-message span { background: var(--bg-card); padding: 6px 14px; border-radius: var(--radius-full); font-size: 12px; color: var(--text-muted); }
        
        /* 匹配卡片 */
        .match-card-message { background: var(--bg-card); border-radius: var(--radius-lg); padding: 14px; margin-top: 8px; box-shadow: var(--shadow-sm); }
        .match-card-title { font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: 8px; }
        .match-card-desc { font-size: 13px; color: var(--text-secondary); margin-bottom: 10px; }
        .match-card-actions { display: flex; gap: 8px; }
        .match-card-btn { flex: 1; padding: 10px; border-radius: var(--radius-md); font-size: 13px; font-weight: 600; cursor: pointer; text-align: center; border: none; }
        .match-card-btn.accept { background: var(--primary-gradient); color: white; }
        .match-card-btn.reject { background: var(--bg-muted); color: var(--text-secondary); }
        
        /* 输入区域 */
        .input-area { padding: 12px 16px; background: var(--bg-card); border-top: 0.5px solid var(--border-light); }
        .input-row { display: flex; align-items: flex-end; gap: 10px; }
        .input-field { flex: 1; background: var(--bg-muted); border-radius: var(--radius-xl); padding: 10px 16px; display: flex; align-items: center; }
        .input-field textarea { flex: 1; border: none; background: transparent; font-size: 15px; outline: none; resize: none; max-height: 100px; color: var(--text-primary); line-height: 1.4; }
        .input-field textarea::placeholder { color: var(--text-muted); }
        .send-btn { width: 42px; height: 42px; background: var(--primary-gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; flex-shrink: 0; box-shadow: var(--shadow-sm); }
        .send-btn i { font-size: 16px; color: white; }
        .send-btn:disabled { background: var(--bg-muted); box-shadow: none; }
        .send-btn:disabled i { color: var(--text-muted); }
        
        .input-actions { display: flex; gap: 16px; margin-top: 10px; justify-content: center; }
        .input-action { display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer; }
        .input-action i { font-size: 20px; color: var(--text-muted); }
        .input-action span { font-size: 11px; color: var(--text-muted); }
    </style>
</head>
<body>
    <div class="phone-frame">
        <div class="chat-header">
            <div class="back-btn" onclick="location.href='chat-list.html'">
                <i class="fas fa-chevron-left"></i>
            </div>
            <div class="chat-avatar"><i class="fas fa-robot"></i></div>
            <div class="chat-info">
                <div class="chat-name">张姐的分身</div>
                <div class="chat-status">在线 · 自动回复中</div>
            </div>
            <div class="header-action">
                <i class="fas fa-ellipsis-v"></i>
            </div>
        </div>

        <div class="messages-container" id="messagesContainer">
            <div class="system-message">
                <span>匹配成功 · 今天 10:30</span>
            </div>

            <div class="message-item received">
                <div class="message-avatar"><i class="fas fa-robot"></i></div>
                <div class="message-content">
                    <div class="message-bubble">你好！我是张姐的分身，看到你需要遛狗服务~ 我周末上午都有空，你家狗狗是什么品种呀？</div>
                    <div class="message-time">10:32</div>
                </div>
            </div>

            <div class="message-item sent">
                <div class="message-avatar"><i class="fas fa-user"></i></div>
                <div class="message-content">
                    <div class="message-bubble">是一只金毛，3岁了，很乖的</div>
                    <div class="message-time">10:35</div>
                </div>
            </div>

            <div class="message-item received">
                <div class="message-avatar"><i class="fas fa-robot"></i></div>
                <div class="message-content">
                    <div class="message-bubble">太好了！我家也养了一只金毛，叫大黄，3岁啦～ 遛狗很有经验的！</div>
                    <div class="message-time">10:36</div>
                </div>
            </div>

            <div class="message-item received">
                <div class="message-avatar"><i class="fas fa-robot"></i></div>
                <div class="message-content">
                    <div class="message-bubble">周六上午10点可以吗？我可以来小区门口接</div>
                    <div class="message-time">10:36</div>
                    <div class="match-card-message">
                        <div class="match-card-title">周六遛狗服务</div>
                        <div class="match-card-desc">时间：周六 10:00-11:00<br>费用：30元/次</div>
                        <div class="match-card-actions">
                            <div class="match-card-btn reject">改时间</div>
                            <div class="match-card-btn accept" onclick="confirmMatch()">确认</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="input-row">
                <div class="input-field">
                    <textarea id="messageInput" rows="1" placeholder="输入消息..." oninput="autoResize(this)"></textarea>
                </div>
                <div class="send-btn" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </div>
            </div>
            <div class="input-actions">
                <div class="input-action">
                    <i class="fas fa-image"></i>
                    <span>图片</span>
                </div>
                <div class="input-action">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>位置</span>
                </div>
                <div class="input-action">
                    <i class="fas fa-clock"></i>
                    <span>预约</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function autoResize(el) {
            el.style.height = 'auto';
            el.style.height = Math.min(el.scrollHeight, 100) + 'px';
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text) return;
            
            const container = document.getElementById('messagesContainer');
            const now = new Date();
            const time = now.getHours() + ':' + String(now.getMinutes()).padStart(2, '0');
            
            container.innerHTML += `
                <div class="message-item sent">
                    <div class="message-avatar"><i class="fas fa-user"></i></div>
                    <div class="message-content">
                        <div class="message-bubble">${text}</div>
                        <div class="message-time">${time}</div>
                    </div>
                </div>
            `;
            
            input.value = '';
            input.style.height = 'auto';
            container.scrollTop = container.scrollHeight;
            
            // 模拟AI回复
            setTimeout(() => {
                container.innerHTML += `
                    <div class="message-item received">
                        <div class="message-avatar"><i class="fas fa-robot"></i></div>
                        <div class="message-content">
                            <div class="message-bubble">好的，收到！我会及时转告张姐的~</div>
                            <div class="message-time">${time}</div>
                        </div>
                    </div>
                `;
                container.scrollTop = container.scrollHeight;
            }, 1000);
        }

        function confirmMatch() {
            alert('已确认预约！张姐会准时上门~');
        }

        // 回车发送
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
    </script>
</body>
</html>
